<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>mahalanobis_arbutus. arbutus 1.1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">arbutus 1.1</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Multivariate measure of model adequacy</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>mahalanobis_arbutus(x)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>x</dt>
      <dd>an <code>arbutus</code> object inherited from <code><a href='compare_pic_stat.html'>compare_pic_stat</a></code></dd>
    </dl>
    
    <div class="Multivariate measure of model adequacy">
      <h2>Multivariate measure of model adequacy</h2>
      
    </div>

    <div class="Value">
      <h2>Value</h2>
      
      <p>the Mahalanobis distance between the observed and simulated test statistic.</p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>
      
      <p>Computes Mahalanobis distance between the observed test statistics and
the simulated test statistics as a multivariate measure of model fit</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>
      
      <p>This function computes the Mahalanobis distance between the observed and simulated
test statistics. The Mahalanobis distance (see <code><a href='http://www.inside-r.org/packages/cran/stats/docs/mahalanobis'>mahalanobis</a></code> is a unit-less and
scale-invariant of the distance
between a single data point (our observed test statistics) and a common point (here the mean of the
simulated test statistics), taking into account the covariance between the test statistics from
the simulated data. It assumes that the distribution of test statistics is multivariate normal.
For the default test statistics (see <code><a href='default_pic_stat.html'>default_pic_stat</a></code>, this condition should be met -- the
exception being the <code><a href='pic_stat_dcdf.html'>pic_stat_dcdf</a></code> statistic, which as it is bounded at 0, will not be. As a result,
if <code><a href='pic_stat_dcdf.html'>pic_stat_dcdf</a></code> is included in the set of test statistic, this function will take the
natural log of the values before computing the Mahalanobis distance. All other test statistics will
be assumed to be normally distributed and used as is.</p>
  
      <p>While the Mahalanobis distance may be a useful test measure in some circumstances, we recommend checking
the test statistics individually for a number of reasons. First, our procedure for calculating the p-values
for the test statistics is general and does not depend on assumptions regarding the distribution of values.
Second, the interpretation from the individual p-values is much more clear from the perspective of either
posterior predictive or parametric bootstrapping theory. Third, and most importantly, the fact that some test
statistics capture the variation in the data better than others provides useful information as to how and why the
model is inadequate.</p>
  
      <p>If only one set of observed
test statistics are available (e.g. from fitting a model using maximum likelihood to a single tree), a single distance
will be returned. If multiple sets of test statistics are available (e.g. from fitting a model using a Bayesian MCMC),
the function will return a distribution of distances.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>data(finch)
phy &lt;- finch$phy
dat &lt;- finch$data[,&quot;wingL&quot;]
unit.tree &lt;- make_unit_tree(phy, data=dat)

## calculate default test stats on observed data
obs &lt;- calculate_pic_stat(unit.tree, stats=NULL)

## simulate data on unit.tree
sim.dat &lt;- simulate_char_unit(unit.tree, nsim=10)

## calculate default test stats on simulated data
sim &lt;- calculate_pic_stat(sim.dat, stats=NULL)

## compare simulated to observed test statistics
res &lt;- compare_pic_stat(obs, sim)

## calculate Mahalanobis distance
mahalanobis_arbutus(res)
</div>
<div class='output'>[1] 15.12915
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>mahalanobis_arbutus</li>
    </ul>
    <ul>
      
    </ul> -->
      
    <h2>See also</h2>
    
<code><a href='compare_pic_stat.html'>compare_pic_stat</a></code>, <code><a href='http://www.inside-r.org/packages/cran/stats/docs/mahalanobis'>mahalanobis</a></code>

        
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>