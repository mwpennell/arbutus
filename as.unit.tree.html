<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>as.unit.tree. arbutus 1.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">arbutus 1.0</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Create unit.tree object</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>as.unit.tree(x, ...)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>x</dt>
      <dd>fitted model object or <code>phylo</code>/<code>multiPhylo</code> object</dd>
      <dt>...</dt>
      <dd>additional arguments</dd>
    </dl>
    
    <div class="Create unit.tree object">
      <h2>Create unit.tree object</h2>
      
    </div>

    <div class="Value">
      <h2>Value</h2>
      
      <p>a <code>unit.tree</code> object containing (or a list of <code>unit.tree</code> objects,
each containing) the following elements:
<dl>
<dt>phy</dt><dd>a <code>phylo</code> object. If a model fitted object has been supplied
(see details), the <code>phylo</code> object will be rescaled based on fitted model
parameters.</dd>
<dt>data</dt><dd>the original comparative data</dd>
<dt>pics</dt><dd>a matrix consisting of the contrasts calculated using the original
data on the (rescaled) phylogeny. The matrix has two columns: the "contrasts" and
a "variance" for each contrast.</dd>
</dl></p>
  
      <p></p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>
      
      <p>Generic method for creating a 'unit.tree' object</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>
      
      <p>This function is a generic function which takes a fitted
model object (from a number of different packages), rescales the phylogeny
based on the model fitted parameters, computes the contrasts on the rescaled
phylogeny and returns an object of class <code>unit.tree</code>. The <code>unit.tree</code> object
can then be used to assess the adequacy of phylogenetic models of continuous character
evolution. Alternatively, the function can take a <code>phylo</code> object or a <code>multiPhylo</code> object
and compute the contrasts on the phylogeny without rescaling. This is only meaningful for
downstream analyses if the phylogenies have been rescaled beforehand. Currently,
the following object types have been implemented:
<ul>
<li> a <code>gfit</code> object returned from fitting a model of continuous character evolution using
  <code>fitContinuous</code> in the <code>geiger</code> package.</p>
  
      <p></li>
<li> a <code>fit.mle</code> object returned from fitting a model of continuous character evolution
  using <code>find.mle</code> in the <code>diversitree</code> package.</p>
  
      <p></li>
<li> a <code>mcmcsamples</code> object returned from fitting a model of continuous character evolution
  using MCMC methods in the <code>diversitree</code> package. <code>as.unit.tree</code> will apply the same
  trait dataset to a set of unit trees based on sampled parameters. By default this will create a
  unit tree for every sample in the mcmc chain. To modify this, additional arguments can be use.
  <code>burnin</code> specifies how many samples to remove from the beginning of the chain.
  <code>thin</code> specifies the thinning interval (e.g. if <code>thin=5</code>, the function will create a unit
  tree from every fifth parameter set sampled.
  <code>sample</code> specifies how many samples to draw from the MCMC run.</p>
  
      <p></li>
<li> a <code>gls</code> object returned from fitting a phylogenetic generalized least squares model
  of character correlation using <code>gls</code> in the <code>nlme</code> package.</p>
  
      <p></li>
<li> a <code>pgls</code> object returned from fitting a phylogenetic generalized least squares model
  of character correlation using <code>pgls</code> in the <code>caper</code> package.</p>
  
      <p></li>
<li> a <code>phylolm</code> object returned from fitting a phylogenetic generalized linear model of
  character correlation using <code>phylolm</code> in the <code>phylolm</code> package. As the phylogeny is not
  returned with the <code>phylolm</code> object, a <code>phy</code> argument must also be specified.</p>
  
      <p></li>
<li> a <code>phylo</code> object. If a <code>phylo</code> object is supplied, the tree is assumed to have been
  rescaled previously. A second argument <code>data</code> must also be provided included the trait
  data as a named vector with names equal to the tip.labels of the phylogeny.</p>
  
      <p></li>
<li> a <code>multiPhylo object</code>. If a <code>multiPhylo</code> object is supplied, the tree is assumed to have been
  rescaled previously. A second argument <code>data</code> must also be provided included the trait
  data as a named vector with names equal to the tip.labels of the phylogenies. Note that this
  function will append the same data set to every tree in the <code>multiPhylo</code> object.
</li>
</ul></p>
  
      <p></p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>## finch data
data(finch)
phy &lt;- finch$phy
dat &lt;- finch$data[,&quot;wingL&quot;]

## using just the given phylogeny
## without rescaling
unit.tree.phy &lt;- as.unit.tree(phy, data=dat)

## &lt;strong&gt;Not run&lt;/strong&gt;: 
# require(geiger)
# ## fit Brownian motion model
# ## using geiger&#39;s fitContinuous function
# fit.bm &lt;- fitContinuous(phy=phy, dat=data, model=&quot;BM&quot;,
#                                  control=list(niter=10))
# 
# ## this creates a &#39;gfit&#39; object which can be used
# ## in &#39;as.unit.tree()&#39;
# unit.tree.geiger &lt;- as.unit.tree(fit.bm)
# unit.tree.geiger
# 
# require(diversitree)
# ## fit Brownian motion model using ML
# ## using diversitree&#39;s find.mle function
# 
# bmlik &lt;- make.bm(phy, data)
# fit.bm.dt &lt;- find.mle(bmlik, 0.1)
# 
# ## this creates a &#39;fit.mle&#39; object which can be used
# ## in &#39;as.unit.tree()&#39;
# unit.tree.dt &lt;- as.unit.tree(fit.bm.dt)
# 
# ## fit Brownian motion model using MCMC
# mcmc.bm.dt &lt;- mcmc(bmlik, x.init=1, nsteps=1000, w=1)
# 
# ## construct a unit tree object from mcmcsamples
# ## removing 100 samples as burnin
# ## and sampling 10 parameter sets
# unit.tree.mcmc &lt;- as.unit.tree(mcmc.bm.dt,
#                        burnin=100, samples=10)
# 
# 
# require(nlme)
# ## Use pgls to look for a correlation between two traits
# 
# t1 &lt;- data
# t2 &lt;- td$data[,&quot;tarsusL&quot;]
# dd &lt;- cbind.data.frame(t1, t2)
# 
# ## fit gls model with corPagel correlation structure
# fit.gls &lt;- gls(t1~t2, data=dd, correlation=corPagel(phy=phy, value=1))
# 
# ## this creates a &#39;gls&#39; object which can be used
# ## in &#39;as.unit.tree()&#39;
# unit.tree.gls &lt;- as.unit.tree(fit.gls)
# 
# ## &lt;strong&gt;End(Not run)&lt;/strong&gt;
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>as.unit.tree</li>
    </ul>
    <ul>
      
    </ul> -->
      
    <h2>See also</h2>
    
<code><a href='http://www.inside-r.org/packages/cran/ape/docs/pic'>pic</a></code>, <code><a href='phy.model.check.html'>phy.model.check</a></code>

        
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>